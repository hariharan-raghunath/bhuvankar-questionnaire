generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ClientSubmission {
  // Primary identifiers
  id                Int      @id @default(autoincrement())  // Auto-incrementing number
  panNumber         String   @unique  // Unique PAN (encrypted) - natural key
  panNumberIv       String
  panNumberAuthTag  String
  
  // Timestamps
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt  // Auto-updates on changes
  submittedAt       DateTime @default(now())
  
  // Personal Details (encrypted where needed)
  fullName          String
  dateOfBirth       DateTime
  nameAsPerPan      String
  mobile            String   // encrypted
  mobileIv          String
  mobileAuthTag     String
  email             String   // encrypted
  emailIv           String
  emailAuthTag      String
  address1          String
  address2          String?
  address3          String?
  city              String
  country           String
  pinCode           String
  aadharNumber      String   // encrypted
  aadharNumberIv    String
  aadharNumberAuthTag String
  
  // Financial Details
  annualIncome          String   // encrypted
  annualIncomeIv        String
  annualIncomeAuthTag   String
  isPoliticallyExposed  Boolean
  
  // Marital Status
  maritalStatus    String
  spouseName       String?
  spouseDob        DateTime?
  spousePan        String?
  spouseMobile     String?
  spouseEmail      String?
  spouseAddressSame String?
  spouseAddress1   String?
  spouseAddress2   String?
  spouseAddress3   String?
  spouseCity       String?
  spouseCountry    String?
  spousePinCode    String?
  placeOfBirth     String?
  
  // Children
  hasChildren      Boolean
  numberOfChildren Int?
  childrenData     Json?
  
  // Investment Info
  employmentStatus  String
  monthlyExpenses   String
  currentSavings    String?
  hasInvestments    Boolean
  investmentTypes   String[]
  financialGoals    String[]
  riskTolerance     String
  timeHorizon       String
  additionalNotes   String?
  
  // Metadata
  ipAddress        String
  userAgent        String
  version          Int      @default(1)  // Track number of updates
  
  @@index([panNumber])
  @@index([email])
  @@index([createdAt])
  @@index([id])
}